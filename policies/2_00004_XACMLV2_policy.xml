<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:2.0:policy:schema:os" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:oasis:names:tc:xacml:2.0:policy:schema:os http://docs.oasis-open.org/xacml/2.0/access_control-xacml-2.0-policy-schema-os.xsd" PolicyId="00004" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
	<Description>&#13;
		The Stool Sample Service (S3) provides the results of samples, which were sent &#13;
		and analysed by our participating partner laboratories. Our archive provides a patient's stool sample history to&#13;
		to detect hints for possible diseases early. Other hospitals can be authorized and granted access to&#13;
		the results to enhance cooperation. To preserve privacy a stool sample is never linked to a patient directly.&#13;
		Stool samples of the same subject are linked against earch other to express that two or many samples belong to&#13;
		a specific subject. By authorizing another hospital the access-granting party is in charge to ensure the access-granted party&#13;
		refers the results to the respective subject. Further the service provides details about laboratories.&#13;
	</Description>
	<Target>
		<Resources>
			<Resource>
				<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
					<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med</AttributeValue>
					<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
				</ResourceMatch>
			</Resource>
		</Resources>
		<Subjects>
		</Subjects>
	</Target>
	<Rule RuleId="0" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/sample/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">post</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
		<Condition>
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
					<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject:role" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</Apply>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">doctor</AttributeValue>
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">intern</AttributeValue>
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">attending</AttributeValue>
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">chief_physician</AttributeValue>
					</Apply>
				</Apply>
			</Apply>
		</Condition>
	</Rule>
	<Rule RuleId="1" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/laboratories/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">get</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
	</Rule>
	<Rule RuleId="2" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/laboratories/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">post</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
	</Rule>
	<Rule RuleId="3" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/laboratory/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">get</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
	</Rule>
	<Rule RuleId="4" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/profile/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">get</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
		<Condition>
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
					<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</Apply>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">PerryCox</AttributeValue>
					</Apply>
				</Apply>
			</Apply>
		</Condition>
	</Rule>
	<Rule RuleId="5" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/profile/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">post</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
		<Condition>
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
					<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</Apply>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">PerryCox</AttributeValue>
					</Apply>
				</Apply>
			</Apply>
		</Condition>
	</Rule>
	<Rule RuleId="6" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/booking/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">get</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
		<Condition>
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
					<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</Apply>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">PerryCox</AttributeValue>
					</Apply>
				</Apply>
			</Apply>
		</Condition>
	</Rule>
	<Rule RuleId="7" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/booking/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">post</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
		<Condition>
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
					<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</Apply>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">PerryCox</AttributeValue>
					</Apply>
				</Apply>
			</Apply>
		</Condition>
	</Rule>
	<Rule RuleId="8" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/settings/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">get</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
		<Condition>
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
					<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</Apply>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">PerryCox</AttributeValue>
					</Apply>
				</Apply>
			</Apply>
		</Condition>
	</Rule>
	<Rule RuleId="9" Effect="Permit">
		<Target>
			<Resources>
				<Resource>
					<ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:regexp-string-match">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">http://www.three-s.med/settings/*</AttributeValue>
						<ResourceAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ResourceMatch>
				</Resource>
			</Resources>
			<Actions>
				<Action>
					<ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">post</AttributeValue>
						<ActionAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:action:action-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</ActionMatch>
				</Action>
			</Actions>
		</Target>
		<Condition>
			<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:and">
				<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
					<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-one-and-only">
						<SubjectAttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:subject:subject-id" DataType="http://www.w3.org/2001/XMLSchema#string"/>
					</Apply>
					<Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-bag">
						<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">PerryCox</AttributeValue>
					</Apply>
				</Apply>
			</Apply>
		</Condition>
	</Rule>
	<Rule RuleId="else" Effect="Deny"/>
</Policy>
